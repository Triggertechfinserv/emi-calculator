<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <!-- Primary SEO -->
  <title>EMI Calculator || Part-Payment — TechFinserv</title>
  <meta name="description" content="Smart EMI calculator for home, car & personal loans. Use part-payments, see instant amortization, export to PDF/Excel, and get complete loan planning for 2025">
  <link rel="canonical" href="https://www.techfinserv.com/emi-calculator/">
  <meta name="robots" content="index, follow, max-image-preview:large">

  <!-- Hreflang (adjust if you have more locales) -->
  <link rel="alternate" href="https://www.techfinserv.com/emi-calculator/" hreflang="en-IN">
  <link rel="alternate" href="https://www.techfinserv.com/emi-calculator/" hreflang="x-default">

  <!-- Performance niceties -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  <!-- Open Graph (Facebook, LinkedIn, WhatsApp, Telegram) -->
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="TechFinserv">
  <meta property="og:locale" content="en_IN">
  <meta property="og:title" content="EMI Calculator || Part-Payment — TechFinserv">
  <meta property="og:description" content="Smart EMI calculator for home, car & personal loans. Use part-payments, see instant amortization, export to PDF/Excel, and get complete loan planning for 2025.">
  <meta property="og:url" content="https://www.techfinserv.com/emi-calculator/">

  <!-- IMPORTANT: Use JPG/PNG for OG (not WebP) -->
  <meta property="og:image" content="https://www.techfinserv.com/images/emi-calculator/emi-calculator.jpg">
  <meta property="og:image:secure_url" content="https://www.techfinserv.com/images/emi-calculator/emi-calculator.jpg">
  <meta property="og:image:type" content="image/jpg">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:image:alt" content="Smart EMI calculator for home, car & personal loans.With part-payments. (infographic)">

  <!-- Twitter / X -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@TechFinservIN">        <!-- your handle -->
  <meta name="twitter:creator" content="@TechFinservIN">     <!-- your handle -->
  <meta name="twitter:title" content="EMI Calculator || Part-Payment — TechFinserv">
  <meta name="twitter:description" content="Smart EMI calculator for home, car & personal loans.With part-payments.">
  <meta name="twitter:image" content="https://www.techfinserv.com/images/emi-calculator/emi-calculator.jpg">
  <meta name="twitter:image:alt" content="Smart EMI calculator for home, car & personal loans.With part-payments.">

  <!-- Favicons / PWA (optional but good) -->
  <link rel="icon" type="image/png" href="/images/favicon.png">
  <link rel="apple-touch-icon" href="/images/favicon.png">
  <link rel="manifest" href="/site.webmanifest">
  <meta name="theme-color" content="#0ea5e9">
  
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />  
  
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "Organization",
      "@id": "https://www.techfinserv.com/#organization",
      "name": "TechFinserv",
      "url": "https://www.techfinserv.com/",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.techfinserv.com/images/techfinserv-logo.png",
        "width": 600,
        "height": 60
      },
      "sameAs": [
        "https://x.com/TechFinservIN",
        "https://www.facebook.com/profile.php?id=61583100667662",
        "https://www.instagram.com/techfinserv",
        "https://www.youtube.com/@TechFinservyt",
        "https://www.linkedin.com/company/techfinserv/"
      ]
    },
    {
      "@type": "WebSite",
      "@id": "https://www.techfinserv.com/#website",
      "url": "https://www.techfinserv.com/",
      "name": "TechFinserv",
      "publisher": { "@id": "https://www.techfinserv.com/#organization" },
      "inLanguage": "en-IN",
      "potentialAction": {
        "@type": "SearchAction",
        "target": "https://www.techfinserv.com/search/?q={search_term_string}",
        "query-input": "required name=search_term_string"
      }
    },
    {
      "@type": "WebPage",
      "@id": "https://www.techfinserv.com/emi-calculator/#webpage",
      "url": "https://www.techfinserv.com/emi-calculator/",
      "name": "EMI Calculator with Part-Payment — TechFinserv",
      "isPartOf": { "@id": "https://www.techfinserv.com/#website" },
      "breadcrumb": { "@id": "https://www.techfinserv.com/emi-calculator/#breadcrumbs" },
      "primaryImageOfPage": {
        "@type": "ImageObject",
        "url": "https://www.techfinserv.com/images/emi-calculator/emi-calculator.jpg",
        "width": 1200,
        "height": 630
      },
      "datePublished": "2025-10-21T00:00:00+05:30",
      "dateModified": "2025-10-21T00:00:00+05:30",
      "inLanguage": "en-IN"
    },
    {
      "@type": "BreadcrumbList",
      "@id": "https://www.techfinserv.com/emi-calculator/#breadcrumbs",
      "itemListElement": [
        { "@type": "ListItem", "position": 1, "name": "Home", "item": "https://www.techfinserv.com/" },
        { "@type": "ListItem", "position": 2, "name": "EMI Calculator", "item": "https://www.techfinserv.com/emi-calculator/" }
      ]
    },
    {
      "@type": "WebApplication",
      "@id": "https://www.techfinserv.com/emi-calculator/#app",
      "name": "EMI Calculator with Part-Payment",
      "url": "https://www.techfinserv.com/emi-calculator/",
      "applicationCategory": "FinanceApplication",
      "operatingSystem": "Web",
      "description": "EMI calculator for home, personal and car loans with part-payment support, instant amortization schedule, and PDF/Excel export.",
      "screenshot": "https://www.techfinserv.com/images/emi-calculator/emi-calculator.jpg",
      "publisher": { "@id": "https://www.techfinserv.com/#organization" },
      "inLanguage": "en-IN"
    },
    {
      "@type": "FAQPage",
      "@id": "https://www.techfinserv.com/emi-calculator/#faq",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "Does EMI change every month?",
          "acceptedAnswer": { "@type": "Answer", "text": "For fixed-rate loans, the EMI stays constant but the interest/principal split changes over time. For floating-rate loans, lenders may change EMI or tenure when rates move." }
        },
        {
          "@type": "Question",
          "name": "Is it better to prepay early or late?",
          "acceptedAnswer": { "@type": "Answer", "text": "Earlier prepayments save more interest because they reduce the outstanding balance when interest is the largest share of EMI." }
        },
        {
          "@type": "Question",
          "name": "Which is better: reduce EMI or reduce tenure?",
          "acceptedAnswer": { "@type": "Answer", "text": "Reducing tenure typically lowers total interest more, while reducing EMI improves monthly cash flow. Choose based on your priorities." }
        },
        {
          "@type": "Question",
          "name": "What fees should I check before prepaying?",
          "acceptedAnswer": { "@type": "Answer", "text": "Look for prepayment or foreclosure charges, minimum part-payment amounts, and how quickly the lender updates your schedule." }
        }
      ]
    }
  ]
}
</script>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-9DHT9T8GZB"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-9DHT9T8GZB');
  </script>
  
  <!-- AdSense loader: include ONCE -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4180233192929131"
          crossorigin="anonymous"></script>

  <!-- Third-party libs for export -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/file-saver/dist/FileSaver.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>

  <style>
    /* === New site theme (light glass) === */
    :root {
      --bg: #f6f9ff;
      --bg-accent1: rgba(14,165,233,0.20);
      --bg-accent2: rgba(16,185,129,0.18);
      --surface: rgba(255,255,255,0.78);
      --surface-strong: rgba(255,255,255,0.92);
      --text: #0f172a;
      --muted: #475569;
      --border: rgba(2,6,23,0.12);
      --accent-1: #0ea5e9;
      --accent-2: #10b981;
      --gradient-solid: linear-gradient(135deg, #10a7e6, #10b981);
      --radius: 16px;
      --shadow: 0 6px 16px rgba(2,6,23,0.08), 0 2px 8px rgba(2,6,23,0.06);
      --maxw: 1200px;

      --input-bg: rgba(255,255,255,0.92);
      --input-focus: rgba(14,165,233,0.25);
      --table-stripe: rgba(2,6,23,0.03);
      --table-head: rgba(2,6,23,0.04);
      /* header height (used when fixed) */
      --header-h: 72px;
    }

    * { box-sizing: border-box; }
    html, body { width:100%; overflow-x:hidden; }
    body {
      margin: 0; font-family: Inter, system-ui, sans-serif; color: var(--text);
      background: var(--bg);
      /* padding is set dynamically to match header height for identical layout */
      padding-top: 0;
    }
    a { color: inherit; text-decoration: none; }
    .container { max-width: var(--maxw); margin: 0 auto; padding: 0 20px; }

    .glass { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius);
      backdrop-filter: blur(10px) saturate(160%); -webkit-backdrop-filter: blur(10px) saturate(160%); box-shadow: var(--shadow); }

    /* Header (new site) — now fixed */
    .topbar { position: fixed; top: 0; left: 0; right: 0; z-index: 40; background: rgba(255,255,255,0.78);
      border-bottom: 1px solid var(--border); box-shadow: var(--shadow); backdrop-filter: blur(12px) saturate(170%); -webkit-backdrop-filter: blur(12px) saturate(170%); }
    header.nav { display:flex; justify-content:space-between; align-items:center; padding: 12px 0; }
    .brand-logo { height: 60px; border-radius: 10px; }
    nav.menu { display:flex; gap:14px; }
    nav.menu a { padding: 8px 12px; border-radius: 10px; color: var(--muted); }
    nav.menu a:hover { background: var(--surface-strong); color: var(--text); }
    .cta { background: var(--gradient-solid); color: #fff; padding: 10px 14px; border-radius: 12px; font-weight: 600; }

    /* Page shell */
    main { padding: 24px 0 60px; }
    .page-title { margin: 16px 0 8px; font-size: 22px; }
    .subtitle { color: var(--muted); font-size: 14px; }

    /* Two-column layout */
    .layout { display:grid; grid-template-columns: 2fr 1fr; gap: 18px; align-items:start; }

    /* Calculator card */
    .calc { padding: 18px; }
    .grid { display:grid; grid-template-columns: repeat(3,1fr); gap: 12px; }
    .grid-1 { display:grid; grid-template-columns: 1fr; gap: 10px; }
    label { font-size: 12px; color: var(--muted); display:block; margin:0 0 6px; }
    input, select { width:100%; padding:10px 12px; border-radius:12px; border:1px solid var(--border); background: var(--input-bg); color: var(--text); outline:none; }
    input:focus, select:focus { box-shadow: 0 0 0 3px var(--input-focus); border-color: transparent; }

    .row { display:flex; gap:10px; align-items:center; }
    .chips { display:flex; gap:8px; flex-wrap:wrap; }
    .chip { display:flex; align-items:center; gap:8px; padding:8px 10px; border-radius:12px; background: var(--surface-strong); border:1px solid var(--border); }

    .btn { display:inline-flex; align-items:center; justify-content:center; gap:8px; padding:10px 14px; border-radius:12px; font-weight:700; font-size:13px; cursor:pointer; border:1px solid var(--border); background: var(--surface-strong); color: var(--text); }
    .btn:hover { background: rgba(2,6,23,0.04); }
    .btn-primary { background: var(--gradient-solid); border: 0; color: #fff; }
    .btn-danger { background: rgba(239,68,68,0.10); color: #b91c1c; border-color: rgba(239,68,68,0.35); }
    .btn-success { background: rgba(16,185,129,0.12); color: #065f46; border-color: rgba(16,185,129,0.35); }

    .summary { display:grid; grid-template-columns: repeat(4,1fr); gap: 12px; margin: 12px 0; }
    .card { padding: 12px 14px; border-radius: 14px; background: var(--surface); border: 1px solid var(--border); }
    .small-muted { font-size: 12px; color: var(--muted); }
    .big { font-size: 20px; font-weight: 800; letter-spacing: 0.2px; }

    .table-wrap { border-radius: 14px; border: 1px solid var(--border); overflow: auto; max-height: 480px; background: rgba(255,255,255,0.5); position: relative; }
    table { width: 100%; border-collapse: collapse; font-size: 13px; }
    thead th { position: sticky; top: 0; z-index: 10; background: var(--surface-strong); color: var(--muted); text-align: right; font-weight: 700;
      box-shadow: 0 1px 0 rgba(2,6,23,0.12) inset, 0 2px 8px rgba(2,6,23,0.06);
    }
    th, td { padding: 10px 10px; border-bottom: 1px solid rgba(2,6,23,0.06); text-align: right; }
    th:first-child, td:first-child { text-align: left; }
    tbody tr:nth-child(odd) { background: var(--table-stripe); }

    /* Right column ad card — non-sticky for manual display ads (policy-safe) */
    .ad-card { position: static; top: 84px; padding: 16px; display: grid; gap: 12px; }
    .ad-slot { border: 1px dashed var(--border); border-radius: 14px; min-height: 250px; display: grid; place-items: center; color: var(--muted); background: var(--surface-strong); }
    .ad-note { font-size: 12px; color: var(--muted); text-align:center; }

    footer { border-top: 1px solid var(--border); padding: 30px 0 80px; color: var(--muted); background: rgba(255,255,255,0.75); }

    /* Responsive */
    @media (max-width: 1000px) {
      .layout { grid-template-columns: 1fr; }
      .summary { grid-template-columns: 1fr 1fr; }
      .ad-card { position: static; }
    }
    @media (max-width: 640px) {
      .summary { grid-template-columns: 1fr; }
      .grid { grid-template-columns: 1fr; }
      .big { font-size: 18px; }
    }

    /* Mobile table -> cards */
    @media (max-width: 600px) {
      table thead { display: none; }
      table, tbody, tr, td { display: block; width: 100%; }
      tr { border: 1px solid var(--border); border-radius: 12px; margin-bottom: 10px; padding: 10px; background: var(--surface); }
      td { display: flex; justify-content: space-between; align-items: center; padding: 6px 0; border: none; text-align: left; font-size: 13px; color: var(--text); }
      td[data-label]:before { content: attr(data-label) ":"; font-weight: 600; margin-right: 10px; color: var(--muted); width: 40%; max-width: 160px; }
      td .value { width: 60%; text-align: right; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    }

    /* =========================
       MOBILE-ONLY header menu (copied style from Home)
       ========================= */
    .mobile-menu-toggle{ display:none; }
    .mobile-menu{ display:none; }

    @media (max-width:768px){
      nav.menu{ display:none; }
      .mobile-menu-toggle{
        display:inline-flex; flex-direction:column; justify-content:center; gap:4px;
        width:28px; height:22px; cursor:pointer; background:transparent; border:0;
      }
      .mobile-menu-toggle span{
        display:block; height:3px; width:100%; background:var(--text); border-radius:2px;
      }
      .mobile-menu{
        display:none; flex-direction:column; gap:6px; padding:10px 0 14px; background:#fff;
        border-bottom:1px solid var(--border);
      }
      .mobile-menu a{ padding:12px 16px; font-size:15px; color:var(--muted); }
      .mobile-menu a:hover{ background: var(--bg); color: var(--text); }

      .ad-card, .ad-slot{ width:100%; }
      .ad-slot ins{ max-width:100% !important; width:100% !important; height:auto !important; display:block !important; }
    }
    .mobile-menu.open{ display:flex !important; }
  </style>
</head>
<body>
  <!-- Header (new site) -->
  <div class="topbar">
    <div class="container">
      <header class="nav" role="banner">
        <a href="/" aria-label="TechFinserv home">
          <img class="brand-logo" src="/images/techfinserv-logo.png" alt="TechFinserv logo">
        </a>

        <!-- desktop menu (unchanged) -->
        <nav class="menu" aria-label="Primary">
          <a href="/">Home</a>
          <a href="/blogs/">Blog</a>
          <a href="/coming-soon.html">About</a>
          <a class="cta" href="/coming-soon.html">Apply Now</a>
        </nav>

        <!-- MOBILE: hamburger (added) -->
        <button class="mobile-menu-toggle" aria-label="Toggle menu" aria-expanded="false" aria-controls="mobileMenu">
          <span></span><span></span><span></span>
        </button>
      </header>

      <!-- MOBILE: dropdown menu (added) -->
      <nav id="mobileMenu" class="mobile-menu" aria-label="Mobile">
        <a href="/">Home</a>
        <a href="/blogs/">Blog</a>
        <a href="/coming-soon.html">Apply Now</a>
      </nav>
    </div>
  </div>

  <main>
    <div class="container">
      <h1 class="page-title">EMI Calculator with Part-Payment</h1>
      <p class="subtitle">EMI calculator for home, personal and car loans with part-payment support, instant amortization schedule, and one-click PDF/Excel export.</p>

      <div class="layout">
        <!-- Left: Calculator -->
        <section id="calculator" class="calc glass" role="region" aria-label="EMI Calculator">
          <!-- Inputs -->
          <div class="grid" style="margin-bottom:12px;">
            <div>
              <label>Loan Amount (Principal)</label>
              <input id="loan" type="number" min="1" value="100000" />
            </div>
            <div>
              <label>Annual Interest Rate (%)</label>
              <input id="rate" type="number" step="0.01" min="0" value="12.50" />
            </div>
            <div>
              <label>Tenure (Years)</label>
              <input id="years" type="number" step="0.25" min="0.1" value="5" />
            </div>
          </div>

          <div style="display:flex; gap:12px; align-items:flex-end; flex-wrap:wrap; margin-bottom:10px;">
            <div style="min-width:220px;">
              <label>Mode</label>
              <select id="mode">
                <option value="tenure">Reduce Tenure (EMI fixed)</option>
                <option value="emi">Reduce EMI (Tenure fixed)</option>
              </select>
            </div>

            <div style="flex:1; min-width:260px;">
              <label>Add Part Payment (Month & Amount)</label>
              <div class="row">
                <input id="ppMonth" type="number" min="1" placeholder="Month (e.g. 12)" style="max-width:140px" />
                <input id="ppAmount" type="number" min="0" placeholder="Amount (e.g. 100000)" />
                <button id="addPp" class="btn btn-primary" type="button">Add</button>
                <button id="clearPps" class="btn btn-danger" type="button">Clear</button>
              </div>
            </div>
          </div>

          <!-- Part payments list -->
          <div style="margin:10px 0 6px;">
            <div class="small-muted">Part Payments (click remove to delete):</div>
            <div id="paymentsList" class="chips" style="margin-top:8px;"></div>
          </div>

          <!-- KPI cards -->
          <div class="summary" id="dashboard">
            <div class="card">
              <div class="small-muted">Initial EMI</div>
              <div id="initialEmi" class="big">0</div>
              <div class="small-muted">before prepayment</div>
            </div>
            <div class="card">
              <div class="small-muted">New Tenure (months)</div>
              <div id="newMonths" class="big">0</div>
            </div>
            <div class="card">
              <div class="small-muted">Total Interest Paid</div>
              <div id="totalInterest" class="big">0</div>
            </div>
            <div class="card">
              <div class="small-muted">Total Payment</div>
              <div id="totalPayment" class="big">0</div>
            </div>
          </div>

          <!-- Schedule + exports -->
          <div class="glass" style="padding:14px; margin-top:12px;">
            <div class="row" style="justify-content: space-between; align-items:center; margin-bottom:8px; flex-wrap:wrap;">
              <strong>Repayment Schedule</strong>
              <div style="display:flex; gap:8px; flex-wrap:wrap;">
                <button id="downloadXLSX" class="btn btn-success" type="button">Download Excel</button>
                <button id="downloadPDF" class="btn" type="button">Download PDF</button>
              </div>
            </div>
            <div class="table-wrap">
              <table id="scheduleTable">
                <thead>
                  <tr><th>Month</th><th>EMI</th><th>Principal</th><th>Interest</th><th>Part Payment</th><th>Outstanding</th></tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>

          <p class="small-muted" style="margin-top:10px;">Tip: add one or more part payments (month number & amount). Choose <em>Reduce Tenure</em> to keep EMI the same (loan closes earlier), or <em>Reduce EMI</em> to keep tenure same and reduce monthly payment. Save the file to keep your data.</p>
        </section>

        <!-- Right: Ad space -->
        <aside class="ad-card glass" aria-label="Ad">
          <!-- first ad RightRail_300x600 (Fixed) -->
          <div class="ad-slot" style="min-height:600px;">
            <ins class="adsbygoogle"
                 style="display:inline-block;width:300px;height:600px"
                 data-ad-client="ca-pub-4180233192929131"
                 data-ad-slot="9154021274"></ins>
            <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
          </div>

          <!-- second ad TopBanner_300x250 (Fixed) -->
          <div class="ad-slot" style="min-height:250px;">
            <ins class="adsbygoogle"
                 style="display:inline-block;width:300px;height:250px"
                 data-ad-client="ca-pub-4180233192929131"
                 data-ad-slot="2241854911"></ins>
            <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
          </div>

          <div class="ad-note">Support ❤️ Us By Clicking Ads</div>
        </aside>
      </div>
      
      <!-- ===== Learn About EMI (Article) ===== -->
      <section id="learn-emi" class="glass" style="margin-top:20px; padding:18px;">
        <h2 style="margin:0 0 8px;">What is EMI?</h2>
        <p>
          <strong>EMI (Equated Monthly Installment)</strong> is the fixed amount you pay every month until your loan is fully repaid.
          Each EMI has two parts—<em>interest</em> on the outstanding balance and a portion of the <em>principal</em>. Early in the
          loan, the interest share is higher; as the balance reduces, more of each EMI goes toward principal. While your EMI amount
          usually remains constant, the <em>split</em> between interest and principal changes over time.
        </p>

        <h3 style="margin:16px 0 8px;">EMI Formula</h3>
        <p class="small-muted">Monthly rate <code>r</code> = Annual rate ÷ 12 ÷ 100; Tenure <code>n</code> = number of months</p>
        <div class="glass" style="padding:12px;">
          <p style="margin:0;">
            <strong>EMI</strong> = <code>P × r × (1 + r)<sup>n</sup> ÷ ((1 + r)<sup>n</sup> − 1)</code>
          </p>
          <ul style="margin:8px 0 0 18px; padding:0;">
            <li><code>P</code> = Principal (loan amount)</li>
            <li><code>r</code> = Monthly interest rate</li>
            <li><code>n</code> = Number of monthly installments</li>
          </ul>
        </div>

        <h3 style="margin:16px 0 8px;">Worked Example</h3>
        <p>
          Suppose you borrow <strong>₹10,00,000</strong> at <strong>10.5% p.a.</strong> for <strong>10 years</strong> (i.e., <code>n = 120</code> months).
          Then <code>r = 10.5 ÷ 12 ÷ 100 = 0.00875</code>.
        </p>
        <div class="glass" style="padding:12px; margin-bottom:14px;">
          <p style="margin:0;">
            EMI = <code>10,00,000 × 0.00875 × (1 + 0.00875)<sup>120</sup> ÷ ((1 + 0.00875)<sup>120</sup> − 1)</code> = <strong>₹13,493</strong>
          </p>
          <p style="margin:6px 0 0;">
            Total paid = <code>₹13,493 × 120 = ₹16,19,220</code>, of which <strong>₹6,19,220</strong> is interest.
          </p>
        </div>

        <!-- Example Table -->
        <div class="glass" style="padding:14px; overflow-x:auto; margin-bottom:16px;">
          <table style="width:100%; border-collapse:collapse; font-size:14px;">
            <thead>
              <tr style="background:var(--table-head);">
                <th style="padding:8px; text-align:left;">Parameter</th>
                <th style="padding:8px; text-align:right;">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td style="padding:8px;">Loan Amount (P)</td>
                <td style="padding:8px; text-align:right;">₹10,00,000</td>
              </tr>
              <tr>
                <td style="padding:8px;">Annual Interest Rate</td>
                <td style="padding:8px; text-align:right;">10.5%</td>
              </tr>
              <tr>
                <td style="padding:8px;">Tenure (n)</td>
                <td style="padding:8px; text-align:right;">120 months (10 years)</td>
              </tr>
              <tr>
                <td style="padding:8px;">Monthly Interest Rate (r)</td>
                <td style="padding:8px; text-align:right;">0.00875</td>
              </tr>
              <tr>
                <td style="padding:8px;">Calculated EMI</td>
                <td style="padding:8px; text-align:right; font-weight:700;">₹13,493</td>
              </tr>
              <tr>
                <td style="padding:8px;">Total Payment</td>
                <td style="padding:8px; text-align:right;">₹16,19,220</td>
              </tr>
              <tr>
                <td style="padding:8px;">Total Interest</td>
                <td style="padding:8px; text-align:right;">₹6,19,220</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3 style="margin:16px 0 8px;">How to Use This EMI Calculator</h3>
        <ol style="margin:0 0 0 18px; padding:0;">
          <li>Enter <strong>Loan Amount</strong>, <strong>Annual Interest</strong>, and <strong>Tenure</strong>.</li>
          <li>Choose a mode:
            <ul style="margin:6px 0 0 16px;">
              <li><strong>Reduce Tenure</strong> — EMI stays same; prepayments shorten the loan.</li>
              <li><strong>Reduce EMI</strong> — Tenure stays same; prepayments lower the EMI.</li>
            </ul>
          </li>
          <li>(Optional) Add <strong>Part Payments</strong> by month and amount. You can add multiple entries.</li>
        </ol>
        <p class="small-muted" style="margin-top:8px;">
          The schedule table shows the month-wise split of principal and interest, any prepayments, and the updated outstanding balance.
        </p>

        <h3 style="margin:16px 0 8px;">Floating / Variable Rate Planning</h3>
        <p>If your loan has a floating rate, test both directions to stay prepared:</p>
        <ul style="margin:0 0 0 18px; padding:0;">
          <li><strong>Optimistic case:</strong> Rate falls by 1–3%. EMI may drop (or you can keep EMI same and finish sooner).</li>
          <li><strong>Pessimistic case:</strong> Rate rises by 1–3%. Check if your cash flow can still handle the EMI comfortably.</li>
        </ul>
        <p class="small-muted" style="margin-top:8px;">
          Try a few “what-if” runs in the calculator to decide a safe EMI and sensible tenure for your situation.
        </p>

        <h3 style="margin:16px 0 8px;">FAQs</h3>
        <details>
          <summary><strong>Does EMI change every month?</strong></summary>
          <p>For fixed-rate loans, the EMI amount stays constant, but the interest/principal split shifts over time. For floating-rate loans, the lender may change EMI or tenure when rates move.</p>
        </details>
        <details>
          <summary><strong>Is it better to prepay early or late?</strong></summary>
          <p>Earlier prepayments save more interest because they reduce the outstanding when interest is the largest share of EMI.</p>
        </details>
        <details>
          <summary><strong>Which is better: reduce EMI or reduce tenure?</strong></summary>
          <p>Reducing tenure usually cuts total interest more. Reducing EMI improves monthly cash flow—pick what suits your goals.</p>
        </details>
        <details>
          <summary><strong>What fees should I check before prepaying?</strong></summary>
          <p>Look for prepayment/foreclosure charges, minimum part-payment amounts, and how quickly the lender updates your schedule.</p>
        </details>

        <h3 style="margin:16px 0 8px;">Glossary</h3>
        <ul style="margin:0 0 0 18px; padding:0;">
          <li><strong>Principal:</strong> Original loan amount borrowed.</li>
          <li><strong>Interest:</strong> Cost of borrowing, charged on the outstanding balance.</li>
          <li><strong>Tenure:</strong> Total time to repay the loan, in months/years.</li>
          <li><strong>Prepayment / Part-payment:</strong> Extra payments made to reduce the outstanding sooner.</li>
          <li><strong>Amortization:</strong> Gradual repayment of principal over time through EMIs.</li>
        </ul>

        <p class="small-muted" style="margin-top:14px;">
          <strong>Disclaimer:</strong> This tool provides estimates for planning only. Actual EMIs/charges depend on lender policies and your loan agreement.
        </p>
      </section>
    </div>
  </main>

 <!-- ====== Footer social icons END ====== -->
<style>
footer.glass .social {
  display:flex; gap:10px; align-items:center; margin:12px 0;
}
footer.glass .social a{
  width:34px;height:34px;display:inline-flex;align-items:center;justify-content:center;
  border-radius:10px;background:#fff;border:1px solid rgba(2,6,23,.10);
  box-shadow:0 4px 10px rgba(2,6,23,.06);
  text-decoration:none; transition:transform .15s ease,border-color .2s ease;
}
footer.glass .social a:hover{ transform:translateY(-2px); border-color:#0ea5e950; }
footer.glass .social svg{ width:18px;height:18px; display:block; }
footer.glass .social .fb svg{ fill:#1877F2; }
footer.glass .social .ig svg{ fill:#E1306C; }
footer.glass .social .ln svg{ fill:#0A66C2; }
footer.glass .social .x  svg{ fill:#111; }
footer.glass .social .yt svg{ fill:#FF0000; }
footer.glass .social .wa svg{ fill:#25D366; }
</style>
<!-- ====== Footer social icons END ====== -->

  <footer class="glass" style="margin-top:24px;">
    <div class="container" style="max-width:1200px;margin:0 auto;padding:0 20px;">
         <div class="social" aria-label="Social links">
      <a class="fb" href="https://www.facebook.com/profile.php?id=61583100667662" target="_blank" rel="noopener noreferrer" aria-label="Facebook">
        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M22 12.06C22 6.48 17.52 2 11.94 2 6.36 2 1.88 6.48 1.88 12.06c0 4.88 3.56 8.93 8.22 9.8v-6.93H7.9v-2.87h2.2V9.6c0-2.18 1.3-3.39 3.3-3.39.96 0 1.97.17 1.97.17v2.16h-1.11c-1.1 0-1.44.69-1.44 1.4v1.68h2.45l-.39 2.87h-2.06v6.93c4.66-.87 8.22-4.92 8.22-9.8z"/></svg>
      </a>
      <a class="ig" href="https://www.instagram.com/techfinserv/" target="_blank" rel="noopener noreferrer" aria-label="Instagram">
        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5zm0 2a3 3 0 0 0-3 3v10a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3V7a3 3 0 0 0-3-3H7zm5 3.5A5.5 5.5 0 1 1 6.5 13 5.51 5.51 0 0 1 12 7.5zm0 2A3.5 3.5 0 1 0 15.5 13 3.5 3.5 0 0 0 12 9.5zm5.75-2.75a1.25 1.25 0 1 1-1.25 1.25 1.25 1.25 0 0 1 1.25-1.25z"/></svg>
      </a>
      <a class="ln" href="https://www.linkedin.com/company/techfinserv" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn">
        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M19 3A2.94 2.94 0 0 1 22 6v12a2.94 2.94 0 0 1-3 3H5a2.94 2.94 0 0 1-3-3V6a2.94 2.94 0 0 1 3-3Zm-9.65 7H6.08v8h3.27Zm.23-2.93a1.86 1.86 0 1 0-1.87 1.86 1.86 1.86 0 0 0 1.87-1.86ZM21 18v-4.27c0-3.06-1.63-4.48-3.81-4.48a3.28 3.28 0 0 0-3 1.65h-.06V10H11v8h3.27v-4.44c0-1.17.22-2.31 1.68-2.31S17.6 12.33 17.6 13.6V18Z"/></svg>
      </a>
      <a class="x" href="https://x.com/TechFinservIN" target="_blank" rel="noopener noreferrer" aria-label="X (Twitter)">
        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M3 3h4.6l5.17 6.96L16.8 3H21l-7.54 9.9L21.3 21h-4.6l-5.5-7.4L7.2 21H2l7.83-10.25z"/></svg>
      </a>
      <a class="yt" href="https://www.youtube.com/@TechFinservYT" target="_blank" rel="noopener noreferrer" aria-label="YouTube">
        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M23.5 6.2s-.23-1.65-.95-2.37c-.9-.95-1.92-.96-2.38-1C16.9 2.4 12 2.4 12 2.4h-.01s-4.9 0-8.17.43c-.46.05-1.48.06-2.38 1C.73 4.55.5 6.2.5 6.2S.27 8.22.27 10.24v1.52c0 2.02.23 4.04.23 4.04s.23 1.65.95 2.37c.9.95 2.08.92 2.61 1.02 1.9.18 7.94.43 7.94.43s4.9 0 8.17-.43c.46-.05 1.48-.06 2.38-1 .72-.72.95-2.37.95-2.37s.23-2.02.23-4.04v-1.52c0-2.02-.23-4.04-.23-4.04ZM9.75 14.41V7.59l6.34 3.41-6.34 3.41Z"/></svg>
      </a>
      <a class="wa" href="https://wa.me/919054356860" target="_blank" rel="noopener noreferrer" aria-label="WhatsApp">
        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M20.52 3.48A11.8 11.8 0 0 0 12.03 0 11.97 11.97 0 0 0 1.8 17.7L0 24l6.45-1.7A11.96 11.96 0 0 0 12.03 24h.01A11.97 11.97 0 0 0 24 12.02a11.8 11.8 0 0 0-3.48-8.54ZM12.04 21.5h-.01a9.45 9.45 0 0 1-4.83-1.32l-.35-.2-3.83 1.01 1.02-3.73-.22-.38a9.48 9.48 0 1 1 8.22 4.62Zm5.49-7.17c-.3-.15-1.78-.88-2.06-.98-.28-.1-.48-.15-.68.15s-.78.98-.96 1.18-.35.22-.64.08a7.73 7.73 0 0 1-2.28-1.41 8.57 8.57 0 0 1-1.58-1.96c-.17-.3 0-.46.13-.62.13-.15.3-.38.45-.58.15-.2.2-.35.3-.58.1-.22.05-.42-.03-.58-.08-.15-.68-1.63-.93-2.23-.24-.6-.5-.5-.68-.5h-.58c-.2 0-.52.08-.8.38-.28.3-1.06 1.03-1.06 2.5s1.09 2.9 1.24 3.11c.15.2 2.14 3.25 5.19 4.55.73.32 1.3.51 1.74.65.73.23 1.4.2 1.93.12.59-.09 1.78-.73 2.03-1.43.25-.7.25-1.3.17-1.43-.08-.13-.28-.2-.58-.35Z"/></svg>
      </a>
    </div>
    <div class="container">
      Designed & Maintained by Kiran Rathva • © <span id="year"></span> TechFinserv.com
    </div>
  </footer>

  <script>
    // Year
    document.getElementById('year').textContent = new Date().getFullYear();

    // Match body padding to exact header height so nothing shifts and layout stays identical
    (function(){
      const topbar = document.querySelector('.topbar');
      if(!topbar) return;
      const setPad = () => { document.body.style.paddingTop = topbar.offsetHeight + 'px'; };
      setPad();
      window.addEventListener('resize', setPad, { passive: true });
    })();

    // ===== Mobile menu toggle (same behavior as Home) =====
    (function () {
      const toggle = document.querySelector('.mobile-menu-toggle');
      const menu = document.getElementById('mobileMenu');
      if (!toggle || !menu) return;

      const setExpanded = (open) => {
        toggle.setAttribute('aria-expanded', String(open));
        menu.classList.toggle('open', open);
      };

      toggle.addEventListener('click', () => {
        const open = !menu.classList.contains('open');
        setExpanded(open);
      }, { passive: true });

      // Close menu when a link is clicked
      menu.addEventListener('click', (e) => {
        if (e.target.tagName === 'A') setExpanded(false);
      }, { passive: true });

      // Reset on resize to desktop & recompute header height padding once
      const onResize = () => {
        if (window.innerWidth > 768) setExpanded(false);
      };
      window.addEventListener('resize', onResize, { passive: true });
    })();

    // =============================
    // LOGIC — performance-optimized (no visual/calculation/content changes)
    // =============================

    const fmt = (v) => {
      const n = Math.round(Number(v) || 0);
      return new Intl.NumberFormat('en-IN', { maximumFractionDigits: 0, minimumFractionDigits: 0 }).format(n);
    };

    function pmt(rate, nper, pv) {
      if (nper === 0) return 0;
      if (Math.abs(rate) < 1e-12) return pv / nper;
      return (pv * rate) / (1 - Math.pow(1 + rate, -nper));
    }

    // DOM
    const loanEl = document.getElementById('loan');
    const rateEl = document.getElementById('rate');
    const yearsEl = document.getElementById('years');
    const modeEl = document.getElementById('mode');

    const ppMonthEl = document.getElementById('ppMonth');
    const ppAmountEl = document.getElementById('ppAmount');
    const paymentsList = document.getElementById('paymentsList');

    const initialEmiEl = document.getElementById('initialEmi');
    const newMonthsEl = document.getElementById('newMonths');
    const totalInterestEl = document.getElementById('totalInterest');
    const totalPaymentEl = document.getElementById('totalPayment');

    const scheduleTbody = document.querySelector('#scheduleTable tbody');
    const downloadXLSXBtn = document.getElementById('downloadXLSX');
    const downloadPDFBtn = document.getElementById('downloadPDF');

    let payments = []; // {month, amount}

    function getInputs() {
      const principal = Math.max(1, Math.round(Number(loanEl.value) || 1));
      const annualRate = Math.max(0, Number(rateEl.value) || 0);
      const tenureYears = Math.max(0.1, Number(yearsEl.value) || 0.1);
      return { principal, annualRate, tenureYears, monthlyRate: annualRate/12/100, monthsInitial: Math.round(Math.max(1, tenureYears*12)) };
    }

    function renderPayments() {
      // Use a single string write to avoid many DOM nodes operations
      if (payments.length === 0) {
        paymentsList.innerHTML = '<div class="small-muted">No part payments added.</div>';
        return;
      }
      let html = '';
      payments.forEach((p, idx) => {
        html += `<div class="chip"><div class="small-muted">Month ${p.month} → <strong>${fmt(p.amount)}</strong></div>` +
                `<button data-rm="${idx}" class="btn btn-danger" style="padding:6px 10px">Remove</button></div>`;
      });
      paymentsList.innerHTML = html;
      // delegate remove clicks (less listeners)
      paymentsList.querySelectorAll('button[data-rm]').forEach(btn => {
        btn.onclick = () => { payments.splice(Number(btn.getAttribute('data-rm')),1); renderPayments(); scheduleDirty = true; scheduleRAF(); };
      });
    }

    function addPayment() {
      const m = Math.max(1, Math.round(Number(ppMonthEl.value) || 0));
      const a = Math.max(0, Math.round(Number(ppAmountEl.value) || 0));
      if (!a) { alert('Please enter a part payment amount > 0'); return; }
      payments.push({month:m, amount:a});
      payments.sort((x,y)=>x.month-y.month);
      ppMonthEl.value=''; ppAmountEl.value='';
      renderPayments();
      scheduleDirty = true; scheduleRAF();
    }

    function clearPayments(){
      if(!confirm('Clear all part payments?')) return;
      payments = [];
      renderPayments();
      scheduleDirty = true; scheduleRAF();
    }

    function computeSchedule() {
      const { principal, monthlyRate, monthsInitial } = getInputs();
      const mode = modeEl.value; // 'tenure' or 'emi'
      const initialEmi = Math.abs(pmt(monthlyRate, monthsInitial, principal));

      // Precompute part-payments per month for O(1) lookup
      const partMap = new Map();
      for (const p of payments) partMap.set(p.month, (partMap.get(p.month)||0) + p.amount);

      const schedule = [];
      let outstanding = principal;
      let emi = initialEmi;
      let remainingMonths = monthsInitial;

      for (let month=1; month<=1200; month++) {
        if (outstanding <= 0.0001) break;
        const interest = outstanding * monthlyRate;
        let principalComp = emi - interest;
        if (principalComp < 0) principalComp = 0;

        const part = partMap.get(month) || 0;

        if (outstanding - principalComp - part <= 0) {
          const finalInterest = outstanding * monthlyRate;
          const finalPrincipal = outstanding;
          const finalEmi = finalPrincipal + finalInterest;
          schedule.push({ month, emi: Math.round(finalEmi), principalPaid: Math.round(finalPrincipal), interestPaid: Math.round(finalInterest), partPayment: Math.round(part), outstanding: 0 });
          outstanding = 0;
          break;
        }

        outstanding = outstanding - principalComp - part;

        if (mode === 'emi' && part > 0) {
          remainingMonths = Math.max(1, monthsInitial - month);
          if (outstanding > 0) {
            emi = Math.abs(pmt(monthlyRate, remainingMonths, outstanding));
          }
        }

        schedule.push({ month, emi: Math.round(emi), principalPaid: Math.round(principalComp), interestPaid: Math.round(interest), partPayment: Math.round(part), outstanding: Math.round(Math.max(0, outstanding)) });

        if (month > monthsInitial + 600) break;
      }

      return { schedule, initialEmi: Math.round(initialEmi) };
    }

    // Efficient render: build a single HTML string and write once
    function renderSchedule(schedule) {
      let rows = '';
      for (let i=0; i<schedule.length; i++) {
        const r = schedule[i];
        rows += `\n<tr>`+
          `<td data-label="Month"><span class="value">${r.month}</span></td>`+
          `<td data-label="EMI"><span class="value">${fmt(r.emi)}</span></td>`+
          `<td data-label="Principal"><span class="value">${fmt(r.principalPaid)}</span></td>`+
          `<td data-label="Interest"><span class="value">${fmt(r.interestPaid)}</span></td>`+
          `<td data-label="Part Payment"><span class="value">${fmt(r.partPayment)}</span></td>`+
          `<td data-label="Outstanding"><span class="value">${fmt(r.outstanding)}</span></td>`+
        `</tr>`;
      }
      scheduleTbody.innerHTML = rows;
    }

    function updateKpis(schedule, initialEmi){
      const totalInterest = schedule.reduce((s,r)=>s+r.interestPaid, 0);
      const principalInput = Math.max(1, Math.round(Number(loanEl.value) || 1));
      const totalPayment = totalInterest + principalInput;

      initialEmiEl.textContent = fmt(initialEmi);
      newMonthsEl.textContent = schedule.length;
      totalInterestEl.textContent = fmt(totalInterest);
      totalPaymentEl.textContent = fmt(totalPayment);
    }

    function computeAndRender(){
      const { schedule, initialEmi } = computeSchedule();
      renderSchedule(schedule);
      updateKpis(schedule, initialEmi);
      lastSchedule = schedule; // cache for exports
      lastInitialEmi = initialEmi;
    }

    // rAF throttle for inputs to avoid jank while typing
    let scheduleDirty = false;
    let rafId = 0;
    let lastSchedule = null;
    let lastInitialEmi = 0;
    function scheduleRAF(){
      if (rafId) return;
      rafId = requestAnimationFrame(() => {
        rafId = 0;
        if (scheduleDirty) {
          scheduleDirty = false;
          computeAndRender();
        }
      });
    }

    // Events
    document.getElementById('addPp').addEventListener('click', addPayment);
    document.getElementById('clearPps').addEventListener('click', clearPayments);

    const onInput = () => { scheduleDirty = true; scheduleRAF(); };
    [loanEl, rateEl, yearsEl, modeEl].forEach(el => el.addEventListener('input', onInput));

    // Export: use cached lastSchedule to avoid recompute during click (but still accurate because we refresh on input)
    function exportXLSX(){
      const schedule = lastSchedule || computeSchedule().schedule;
      const hasPart = payments.some(p => p.amount && p.amount > 0);
      const aoa = [ ['Loan Amount', loanEl.value], ['Annual Rate (%)', rateEl.value], ['Tenure (Years)', yearsEl.value], ['Mode', modeEl.value], [], ];
      if (hasPart) {
        aoa.push(['Month','EMI','Principal Paid','Interest Paid','Part Payment','Outstanding']);
        schedule.forEach(r => aoa.push([r.month, r.emi, r.principalPaid, r.interestPaid, r.partPayment, r.outstanding]));
      } else {
        aoa.push(['Month','EMI','Principal Paid','Interest Paid','Outstanding']);
        schedule.forEach(r => aoa.push([r.month, r.emi, r.principalPaid, r.interestPaid, r.outstanding]));
      }
      const ws = XLSX.utils.aoa_to_sheet(aoa);
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, 'Schedule');
      const wbout = XLSX.write(wb, {bookType:'xlsx', type:'array'});
      try { saveAs(new Blob([wbout],{type:"application/octet-stream"}), 'emi_schedule.xlsx'); } catch(e) { alert('Excel export failed: ' + e.message); }
    }

    function exportPDF(){
      const scheduleData = lastSchedule || computeSchedule().schedule;
      const initialEmi = lastInitialEmi || computeSchedule().initialEmi;
      const loan = Math.round(Number(loanEl.value) || 0);
      const rate = Number(rateEl.value) || 0;
      const years = Number(yearsEl.value) || 0;
      const hasPart = payments.some(p => p.amount && p.amount > 0);

      const { jsPDF } = window.jspdf;
      const doc = new jsPDF({ unit: 'pt', format: 'a4' });
      const pageWidth = doc.internal.pageSize.getWidth();
      const margin = 40;
      let y = 40;

      doc.setFillColor(246, 249, 255);
      doc.rect(0,0,pageWidth,60,'F');
      doc.setFontSize(18);
      doc.setTextColor(15,23,42);
      doc.text('EMI Repayment Schedule', margin, 40);

      y = 80;
      const cardW = 140; const cardH = 40; const gap = 12;
      const cards = [
        {label:'Loan Amount', value: fmt(loan), color: [14,165,233]},
        {label:'Rate (%)', value: String(rate), color: [16,185,129]},
        {label:'Tenure (yrs)', value: String(years), color: [234,179,8]},
        {label:'Initial EMI', value: fmt(initialEmi), color: [99,102,241]}
      ];
      let x = margin;
      cards.forEach(c=>{
        doc.setFillColor(c.color[0], c.color[1], c.color[2]);
        doc.roundedRect(x, y, cardW, cardH, 6, 6, 'F');
        doc.setTextColor(255,255,255);
        doc.setFontSize(10);
        doc.text(c.label, x + 10, y + 14);
        doc.setFontSize(13);
        doc.setFont(undefined, 'bold');
        doc.text(c.value, x + 10, y + 30);
        doc.setFont(undefined, 'normal');
        x += cardW + gap;
      });

      y += cardH + 18;

      const head = hasPart ? [['Month','EMI','Principal','Interest','Part Payment','Outstanding']] : [['Month','EMI','Principal','Interest','Outstanding']];
      const body = scheduleData.map(r => hasPart ? [r.month, r.emi, r.principalPaid, r.interestPaid, r.partPayment, r.outstanding] : [r.month, r.emi, r.principalPaid, r.interestPaid, r.outstanding]);

      doc.autoTable({
        startY: y,
        head: head,
        body: body,
        styles: { fontSize: 9 },
        headStyles: { fillColor: [245,245,245], textColor: 20 },
        margin: { left: margin, right: margin },
        didDrawPage: function (data) {
          const page = doc.internal.getNumberOfPages();
          doc.setFontSize(9);
          doc.setTextColor(120);
          doc.text('Page ' + page, data.settings.margin.left, doc.internal.pageSize.height - 10);
        },
        theme: 'grid'
      });

      doc.save('emi_schedule.pdf');
    }

    downloadXLSXBtn.addEventListener('click', exportXLSX);
    downloadPDFBtn.addEventListener('click', exportPDF);

    // First render
    renderPayments();
    computeAndRender();
  </script>
</body>
</html>
